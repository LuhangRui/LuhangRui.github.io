---
title: 关于浏览器请求PHP一次请求执行了两次
tags: PHP
category: 爬坑日常
thumbnail: /images/postsimages/20181217.jpg
abbrlink: 3834
date: 2019-01-08 11:26:09
---

> 测试同学今天又双叒反馈了一个Bug

继上次解决了重复请求的问题之后，本来就以为可以万事大吉了，没想到我还是太年轻了，测试同学说，不行啊，老哥，你这个我点击了一次创建居然创建出来两条数据！！并且查看日志的时候，确实是发了两次网络请求！！！

我：？？？？？

![真是让人头秃啊](/images/postsimages/2018121701.jpg)

> 排查

1.先看看是不是JS的问题，我们看一下network跟踪一下，没有啊，这只发送了一个请求，挠头，继续，

2.好的，我去我的工位上复现一下，在JS处打断点，没有啊，ajax这里只进来一次，好吧，继续查，

3.好的，把host地址改向测试机,请求，我擦，日志正常，结果也正常是一条数据啊，根本没办法复现啊。

这。。。It works on my computer ! 这就非常的有趣了，测试同学和我访问的都是同一台测试机，为什么，我创建没问题，他创建就有问题呢。好奇怪，首要之急要解决问题的话，就避免重复请求，在代码里判断一下请求间隔。可是不应该啊，有这么麻烦么？我不死心啊？

> 猜想&&解决

讲道理，没道理一个请求到后边代码会执行两次的，会不会是有个多个进程的原因？我们重启一下`NGINX`好了，在服务机上执行

```shell
/etc/init.d/nginx resatrt
```

测试大哥，快执行一下试试，诶，好了耶。

好的，完美。